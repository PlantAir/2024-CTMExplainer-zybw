2024-06-10 14:03:04,525 - root - INFO - Namespace(data='wikipedia', bs=200, prefix='tgn-attn', n_degree=10, n_head=2, n_epoch=10, n_layer=2, lr=0.0001, patience=5, n_runs=1, drop_out=0.1, gpu=0, node_dim=100, time_dim=100, backprop_every=1, use_memory=True, embedding_module='graph_attention', message_function='identity', memory_updater='gru', aggregator='last', memory_update_at_end=False, message_dim=100, memory_dim=172, different_new_nodes=False, uniform=False, randomize_features=False, use_destination_embedding_in_message=False, use_source_embedding_in_message=False, dyrep=False)
2024-06-10 14:03:05,494 - root - INFO - num of training instances: 79202
2024-06-10 14:03:05,494 - root - INFO - num of batches per epoch: 397
2024-06-10 14:03:05,494 - root - INFO - start 0 epoch
2024-06-10 14:09:23,353 - root - INFO - epoch: 0 took 377.86s
2024-06-10 14:09:23,353 - root - INFO - Epoch mean loss: 0.8457292822806601
2024-06-10 14:09:23,353 - root - INFO - val auc: 0.9183373670896928, new node val auc: 0.9122883921756848
2024-06-10 14:09:23,353 - root - INFO - val ap: 0.9245627400697612, new node val ap: 0.9180911413536007
2024-06-10 14:09:23,353 - root - INFO - val acc: 0.8254581832733092, new node val acc: 0.8187801384578659
2024-06-10 14:09:23,373 - root - INFO - start 1 epoch
2024-06-10 14:16:00,977 - root - INFO - epoch: 1 took 397.62s
2024-06-10 14:16:00,978 - root - INFO - Epoch mean loss: 0.8391452586320546
2024-06-10 14:16:00,978 - root - INFO - val auc: 0.9142279164046572, new node val auc: 0.9160793781668286
2024-06-10 14:16:00,978 - root - INFO - val ap: 0.9229390598759676, new node val ap: 0.9248012484424175
2024-06-10 14:16:00,978 - root - INFO - val acc: 0.8318557422969188, new node val acc: 0.8365033420864167
2024-06-10 14:16:00,998 - root - INFO - start 2 epoch
2024-06-10 14:22:07,596 - root - INFO - epoch: 2 took 366.61s
2024-06-10 14:22:07,596 - root - INFO - Epoch mean loss: 0.711406097454148
2024-06-10 14:22:07,596 - root - INFO - val auc: 0.9296125438270547, new node val auc: 0.9355247473261626
2024-06-10 14:22:07,596 - root - INFO - val ap: 0.9363583190090027, new node val ap: 0.9427559300266903
2024-06-10 14:22:07,596 - root - INFO - val acc: 0.8491356542617047, new node val acc: 0.8559274289806635
2024-06-10 14:22:07,621 - root - INFO - start 3 epoch
2024-06-10 14:27:57,332 - root - INFO - epoch: 3 took 349.73s
2024-06-10 14:27:57,332 - root - INFO - Epoch mean loss: 0.6569830300075281
2024-06-10 14:27:57,332 - root - INFO - val auc: 0.9343725166256981, new node val auc: 0.940376159643466
2024-06-10 14:27:57,332 - root - INFO - val ap: 0.9405781944612027, new node val ap: 0.9475052441012812
2024-06-10 14:27:57,332 - root - INFO - val acc: 0.8492396958783514, new node val acc: 0.8608349248030556
2024-06-10 14:27:57,354 - root - INFO - start 4 epoch
2024-06-10 14:33:39,164 - root - INFO - epoch: 4 took 341.82s
2024-06-10 14:33:39,164 - root - INFO - Epoch mean loss: 0.6282229569156464
2024-06-10 14:33:39,164 - root - INFO - val auc: 0.9332613790754397, new node val auc: 0.9403118780659607
2024-06-10 14:33:39,165 - root - INFO - val ap: 0.9388548815224754, new node val ap: 0.9472024411230205
2024-06-10 14:33:39,165 - root - INFO - val acc: 0.8523489395758304, new node val acc: 0.8618285987109094
2024-06-10 14:33:39,187 - root - INFO - start 5 epoch
2024-06-10 14:39:12,702 - root - INFO - epoch: 5 took 333.53s
2024-06-10 14:39:12,702 - root - INFO - Epoch mean loss: 0.6357586482910426
2024-06-10 14:39:12,702 - root - INFO - val auc: 0.9343492899540768, new node val auc: 0.9423420113963802
2024-06-10 14:39:12,703 - root - INFO - val ap: 0.9414197993741411, new node val ap: 0.9488587959155824
2024-06-10 14:39:12,703 - root - INFO - val acc: 0.8539125650260104, new node val acc: 0.8671753401766532
2024-06-10 14:39:12,725 - root - INFO - start 6 epoch
2024-06-10 14:44:41,126 - root - INFO - epoch: 6 took 328.41s
2024-06-10 14:44:41,126 - root - INFO - Epoch mean loss: 0.6253510609982296
2024-06-10 14:44:41,126 - root - INFO - val auc: 0.9385540354236932, new node val auc: 0.9479489819076791
2024-06-10 14:44:41,126 - root - INFO - val ap: 0.9466112527856064, new node val ap: 0.9549704006000105
2024-06-10 14:44:41,126 - root - INFO - val acc: 0.8578001200480194, new node val acc: 0.874557770350919
2024-06-10 14:44:41,150 - root - INFO - start 7 epoch
2024-06-10 14:50:04,495 - root - INFO - epoch: 7 took 323.36s
2024-06-10 14:50:04,495 - root - INFO - Epoch mean loss: 0.5945163526823298
2024-06-10 14:50:04,495 - root - INFO - val auc: 0.942689684207016, new node val auc: 0.947018196256796
2024-06-10 14:50:04,495 - root - INFO - val ap: 0.9493388771775026, new node val ap: 0.9525579457587822
2024-06-10 14:50:04,495 - root - INFO - val acc: 0.8653641456582633, new node val acc: 0.8651163762234423
2024-06-10 14:50:04,519 - root - INFO - start 8 epoch
2024-06-10 14:55:27,277 - root - INFO - epoch: 8 took 322.77s
2024-06-10 14:55:27,277 - root - INFO - Epoch mean loss: 0.5938283075913975
2024-06-10 14:55:27,277 - root - INFO - val auc: 0.9460654164046571, new node val auc: 0.9499442465427562
2024-06-10 14:55:27,277 - root - INFO - val ap: 0.9524880035727388, new node val ap: 0.9552319955218148
2024-06-10 14:55:27,277 - root - INFO - val acc: 0.8711844737895159, new node val acc: 0.8717110288851755
2024-06-10 14:55:27,305 - root - INFO - start 9 epoch
2024-06-10 15:00:43,387 - root - INFO - epoch: 9 took 316.10s
2024-06-10 15:00:43,387 - root - INFO - Epoch mean loss: 0.5837180408782863
2024-06-10 15:00:43,387 - root - INFO - val auc: 0.947001400083843, new node val auc: 0.9500666319653418
2024-06-10 15:00:43,387 - root - INFO - val ap: 0.9540170273228942, new node val ap: 0.955229072171741
2024-06-10 15:00:43,387 - root - INFO - val acc: 0.8695638255302122, new node val acc: 0.8713798042492241
2024-06-10 15:01:29,634 - root - INFO - Test statistics: Old nodes -- auc: 0.9319653509022655, ap: 0.94108466885264, acc: 0.8488395358143257
2024-06-10 15:01:29,634 - root - INFO - Test statistics: New nodes -- auc: 0.9228101008155517, ap: 0.9320758305600558, acc: 0.83173343605547
2024-06-10 15:01:29,634 - root - INFO - Saving TGN model
2024-06-10 15:01:29,787 - root - INFO - TGN model saved
